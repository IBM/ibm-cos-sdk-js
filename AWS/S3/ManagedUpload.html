<!DOCTYPE html>
<html>
  <head>
    <meta name="guide-name" content="API Reference">
    <meta name="service-name" content="AWS SDK for JavaScript">
    <script type="text/javascript" src="/assets/js/awsdocs-boot.js"></script>
    <meta charset="utf-8">
<title>
  Class: AWS.S3.ManagedUpload
  
    &mdash; IBM COS SDK for JavaScript
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../css/highlight.github.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../css/custom.css" type="text/css" media="screen" charset="utf-8" />


  
    <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
  

  
    <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>
  

  
    <script type="text/javascript" charset="utf-8" src="../../js/highlight.pack.js"></script>
  

  
    <script type="text/javascript" charset="utf-8" src="../../js/custom.js"></script>
  

  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (M)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../AWS.html" title="AWS (module)">AWS</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../S3.html" title="AWS.S3 (class)">S3</a></span></span>
     &raquo; 
    <span class="title">ManagedUpload</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content">
        <div class="alert alert-info">
	<div class="alert-icon"></div>
	<div>
		<div class="alert-header">You are viewing the documentation for an older major version of the AWS SDK for JavaScript.</div>
		<div class="alert-content">
			The modular AWS SDK for JavaScript (v3), the latest major version of AWS SDK for JavaScript, is now stable and recommended for general use.
			For more information, see the
				<a href="https://docs.aws.amazon.com/sdk-for-javascript/v3/developer-guide/migrating-to-v3.html">Migration Guide</a> and 
				<a href="https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/index.html">API Reference.</a>
		</div>
	</div>
</div>
        <!--REGION_DISCLAIMER_DO_NOT_REMOVE-->
        <h1>Class: AWS.S3.ManagedUpload
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">AWS.S3.ManagedUpload</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/s3/managed_upload.js</dd>
  </dl>
  
</div>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>The managed uploader allows for easy and efficient uploading of buffers,
blobs, or streams, using a configurable amount of concurrency to perform
multipart uploads where possible. This abstraction also enables uploading
streams of unknown size due to the use of multipart uploads.</p>

<p>To construct a managed upload object, see the <span class='object_link'><a href="#constructor-property" title="AWS.S3.ManagedUpload.constructor (property)">constructor()</a></span> function.</p>

<h2>Tracking upload progress</h2>

<p>The managed upload object can also track progress by attaching an
'httpUploadProgress' listener to the upload manager. This event is similar
to <span class='object_link'><a href="../Request.html#httpUploadProgress-event" title="AWS.Request~httpUploadProgress (event)">AWS.Request~httpUploadProgress</a></span> but groups all concurrent upload progress
into a single event. See <span class='object_link'><a href="#httpUploadProgress-event" title="AWS.S3.ManagedUpload~httpUploadProgress (event)">httpUploadProgress</a></span> for more
information.</p>

<h2>Handling Multipart Cleanup</h2>

<p>By default, this class will automatically clean up any multipart uploads
when an individual part upload fails. This behavior can be disabled in order
to manually handle failures by setting the <code>leavePartsOnError</code> configuration
option to <code>true</code> when initializing the upload object.</p>


  </div>
</div>
<div class="tags">
  


</div>


<h2>Constructor Summary
  <small><a href="#" class="summary_toggle">collapse</a></small>
</h2>

<ul class="summary">
  
    <li class="public ">
  <span class="summary_signature">
    
      <a href="#constructor-property" title="AWS.S3.ManagedUpload">new <strong>AWS.S3.ManagedUpload</strong>(options) &#x21d2; void </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Creates a managed upload object with a set of configuration options.</p>
</div></span>
  
</li>

  
</ul>

  <h2>Event Summary
    <small><a href="#" class="summary_toggle">collapse</a></small>
  </h2>

  <ul class="summary">
    
    <li class="public ">
      <span class="summary_signature"><strong><span class='object_link'><a href="#httpUploadProgress-event" title="AWS.S3.ManagedUpload~httpUploadProgress (event)">'httpUploadProgress'</a></span></strong></span>
      <span class="note title event"><strong>function</strong> (progress)</span>

      
        <span class="summary_desc"><div class='inline'><p>Triggered when the uploader has uploaded more data.</p>
</div></span>
      
    </li>
    
  </ul>


  <h2> Property Summary
    <small><a href="#" class="summary_toggle">collapse</a></small>
  </h2>

  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#maxTotalParts-property" title="maxTotalParts"><strong>maxTotalParts</strong> &#x21d2; Number </a>
    

    
  </span>
  
    <span class="note title constructor">static</span>
  
  
  
  
    <span class="note title readonly">readonly</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#minPartSize-property" title="minPartSize"><strong>minPartSize</strong> &#x21d2; Number </a>
    

    
  </span>
  
    <span class="note title constructor">static</span>
  
  
  
  
    <span class="note title readonly">readonly</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The minimum number of bytes for an individual part upload.</p>
</div></span>
  
</li>

    
  </ul>




  <h2> Method Summary
    <small><a href="#" class="summary_toggle">collapse</a></small>
  </h2>

  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#abort-property" title="abort"><strong>abort</strong>() &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Aborts a managed upload, including all concurrent upload requests.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#promise-property" title="promise"><strong>promise</strong>() &#x21d2; Promise </a>
    

    
  </span>
  
  
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns a 'thenable' promise.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#send-property" title="send"><strong>send</strong>(callback) &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Initiates the managed upload for the payload.</p>
</div></span>
  
</li>

    
  </ul>



<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="constructor-property">
  
    new <strong>AWS.S3.ManagedUpload</strong>(options) &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>A "Body" parameter is required to be set prior to calling <span class='object_link'><a href="#send-property" title="AWS.S3.ManagedUpload.send (property)">send()</a></span>.</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>In Node.js, sending "Body" as <a href="https://nodejs.org/dist/latest/docs/api/stream.html#stream_object_mode" target="_parent" title="object-mode stream">object-mode stream</a>
may result in upload hangs. Using buffer stream is preferable.</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>ContentMD5 should not be provided when using the managed upload object.
Instead, setting "computeChecksums" to true will enable automatic ContentMD5 generation
by the managed upload object.</p>
</div>
  </div>

<p>Creates a managed upload object with a set of configuration options.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Creating a default uploader for a stream object</p>
</div></p>
      
      <pre class="example code"><code>var upload = new AWS.S3.ManagedUpload({
  params: {Bucket: &#39;bucket&#39;, Key: &#39;key&#39;, Body: stream}
});</code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Creating an uploader with concurrency of 1 and partSize of 10mb</p>
</div></p>
      
      <pre class="example code"><code>var upload = new AWS.S3.ManagedUpload({
  partSize: 10 * 1024 * 1024, queueSize: 1,
  params: {Bucket: &#39;bucket&#39;, Key: &#39;key&#39;, Body: stream}
});</code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Creating an uploader with tags</p>
</div></p>
      
      <pre class="example code"><code>var upload = new AWS.S3.ManagedUpload({
  params: {Bucket: &#39;bucket&#39;, Key: &#39;key&#39;, Body: stream},
  tags: [{Key: &#39;tag1&#39;, Value: &#39;value1&#39;}, {Key: &#39;tag2&#39;, Value: &#39;value2&#39;}]
});</code></pre>
    
  </div>


  
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">params</span>
          <span class="type">(<tt>map</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>a map of parameters to pass to the upload
requests. The "Body" parameter is required to be specified either on
the service or in the params option.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">queueSize</span>
          <span class="type">(<tt>Number</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>4</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>the size of the concurrent queue
manager to upload parts in parallel. Set to 1 for synchronous uploading
of parts. Note that the uploader will buffer at most queueSize * partSize
bytes into memory at any given time.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">partSize</span>
          <span class="type">(<tt>Number</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>5mb</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>the size in bytes for each
individual part to be uploaded. Adjust the part size to ensure the number
of parts does not exceed <span class='object_link'><a href="#maxTotalParts-property" title="AWS.S3.ManagedUpload.maxTotalParts (property)">maxTotalParts</a></span>. See <span class='object_link'><a href="#minPartSize-property" title="AWS.S3.ManagedUpload.minPartSize (property)">minPartSize</a></span> for the
minimum allowed part size.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">leavePartsOnError</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>whether to abort the
multipart upload if an error occurs. Set to true if you want to handle
failures manually.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">service</span>
          <span class="type">(<tt><span class='object_link'><a href="../../AWS.html" title="AWS (module)">AWS</a></span>.<span class='object_link'><a href="../S3.html" title="AWS.S3 (class)">S3</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>an optional S3 service object to use for
requests. This object might have bound parameters used by the uploader.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">tags</span>
          <span class="type">(<tt>Array&lt;map&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>The tags to apply to the uploaded object.
Each tag should have a <code>Key</code> and <code>Value</code> keys.</p>
</div>
          
        </li>
      
    </ul>
  


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#send-property" title="AWS.S3.ManagedUpload.send (property)">send()</a></span></li>
    
  </ul>

</div>
</div>
  
</div>

  <div id="event_details" class="method_details">
    <h2>Event Details</h2>
    
      <div class="method_details first">
      <h3 class="signature first" id="httpUploadProgress-event">
    <strong>'httpUploadProgress'</strong> &mdash; <strong>function</strong> (progress)
    </h3>
<div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>The <code>total</code> property may not be set if the stream being uploaded has
not yet finished chunking. In this case the <code>total</code> will be undefined
until the total stream size is known.</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>This event will not be emitted in Node.js 0.8.x.</p>
</div>
  </div>

<p>Triggered when the uploader has uploaded more data.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Context (<tt>this</tt>):</p>
<ul class="context">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Request.html" title="AWS.Request (class)">Request</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the request object that was sent</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>progress</span>
      
      
        <span class='type'>(<tt>map</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>An object containing the <code>loaded</code> and <code>total</code> bytes
of the request and the <code>key</code> of the S3 object. Note that <code>total</code> may be undefined until the payload
size is known.</p>
</div>
      
    </li>
  
</ul>



</div>
</div>
    
  </div>


  <div id="prop_details" class="method_details">
    <h2>Property Details</h2>
    
      <div class="method_details first">
  <h3 class="signature first" id="maxTotalParts-property">
  
    <strong>maxTotalParts</strong> &#x21d2; <tt>Number</tt>  <span class="extras">(static, readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    


  </div>
</div>
<div class="tags">
  <p class="tag_title">Default Value:</p>
<div class="examples">

  <pre class="example code value_tag"><code>AWS.S3.ManagedUpload.maxTotalParts = 10000</code></pre>

</div>


</div>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="minPartSize-property">
  
    <strong>minPartSize</strong> &#x21d2; <tt>Number</tt>  <span class="extras">(static, readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns the minimum number of bytes for an individual part
upload.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Default Value:</p>
<div class="examples">

  <pre class="example code value_tag"><code>AWS.S3.ManagedUpload.minPartSize = 1024 * 1024 * 5</code></pre>

</div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Number</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the minimum number of bytes for an individual part
upload.</p>
</div>
      
    </li>
  
</ul>

</div>
</div>
    
  </div>


  <div id="method_details" class="method_details">
    <h2>Method Details</h2>
    
      <div class="method_details first">
  <h3 class="signature first" id="abort-property">
  
    <strong>abort</strong>() &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>By default, calling this function will cleanup a multipart upload
if one was created. To leave the multipart upload around after aborting
a request, configure <code>leavePartsOnError</code> to <code>true</code> in the <span class='object_link'><a href="#constructor-property" title="AWS.S3.ManagedUpload.constructor (property)">constructor()</a></span>.</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>Calling <span class='object_link'><a href="#abort-property" title="AWS.S3.ManagedUpload.abort (property)">abort()</a></span> in the browser environment will not abort any requests
that are already in flight. If a multipart upload was created, any parts
not yet uploaded will not be sent, and the multipart upload will be cleaned up.</p>
</div>
  </div>

<p>Aborts a managed upload, including all concurrent upload requests.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Aborting an upload</p>
</div></p>
      
      <pre class="example code"><code>var params = {
  Bucket: &#39;bucket&#39;, Key: &#39;key&#39;,
  Body: Buffer.alloc(1024 * 1024 * 25) // 25MB payload
};
var upload = s3.upload(params);
upload.send(function (err, data) {
  if (err) console.log(&quot;Error:&quot;, err.code, err.message);
  else console.log(data);
});

// abort request in 1 second
setTimeout(upload.abort.bind(upload), 1000);</code></pre>
    
  </div>



</div>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="promise-property">
  
    <strong>promise</strong>() &#x21d2; <tt>Promise</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns a 'thenable' promise.</p>

<p>Two callbacks can be provided to the <code>then</code> method on the returned promise.
The first callback will be called if the promise is fulfilled, and the second
callback will be called if the promise is rejected.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Sending an upload request using promises.</p>
</div></p>
      
      <pre class="example code"><code>var upload = s3.upload({Bucket: &#39;bucket&#39;, Key: &#39;key&#39;, Body: stream});
var promise = upload.promise();
promise.then(function(data) { ... }, function(err) { ... });</code></pre>
    
  </div>

  <p class="tag_title">Callbacks:</p>
  <ul class="callback">
    
      
      <li class="callback_item">
        <span class="signature"><strong>function</strong>(data) { ... } </span>
        <div class="docstring">
  <div class="discussion">
    <p>Called if the promise is fulfilled.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>data</span>
      
      
        <span class='type'>(<tt>map</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The response data from the successful upload:
<code>Location</code> (String) the URL of the uploaded object
<code>ETag</code> (String) the ETag of the uploaded object
<code>Bucket</code> (String) the bucket to which the object was uploaded
<code>Key</code> (String) the key to which the object was uploaded</p>
</div>
      
    </li>
  
</ul>



</div>
      </li>
    
      
      <li class="callback_item">
        <span class="signature"><strong>function</strong>(err) { ... } </span>
        <div class="docstring">
  <div class="discussion">
    <p>Called if the promise is rejected.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>err</span>
      
      
        <span class='type'>(<tt>Error</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>an error or null if no error occurred.</p>
</div>
      
    </li>
  
</ul>



</div>
      </li>
    
  </ul>


<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Promise</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A promise that represents the state of the upload request.</p>
</div>
      
    </li>
  
</ul>

</div>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="send-property">
  
    <strong>send</strong>(callback) &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Initiates the managed upload for the payload.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Sending a managed upload object</p>
</div></p>
      
      <pre class="example code"><code>var params = {Bucket: &#39;bucket&#39;, Key: &#39;key&#39;, Body: stream};
var upload = new AWS.S3.ManagedUpload({params: params});
upload.send(function(err, data) {
  console.log(err, data);
});</code></pre>
    
  </div>

  
  <p class="tag_title">Callback (<tt>callback</tt>):</p>
  <ul class="callback">
    <li class="callback_item">
      <span class="signature"><strong>function</strong>(err, data) { ... } </span>
      <div class="docstring">
  <div class="discussion">
    


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>err</span>
      
      
        <span class='type'>(<tt>Error</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>an error or null if no error occurred.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>data</span>
      
      
        <span class='type'>(<tt>map</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The response data from the successful upload:
* <code>Location</code> (String) the URL of the uploaded object
* <code>ETag</code> (String) the ETag of the uploaded object
* <code>Bucket</code> (String) the bucket to which the object was uploaded
* <code>Key</code> (String) the key to which the object was uploaded</p>
</div>
      
    </li>
  
</ul>



</div>
    </li>
  </ul>



</div>
</div>
    
  </div>


      </div>

      <div id="footer">
  <div>
    Generated on Mon Jul 11 16:53:19 2022 by
    <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
    0.9.26 (ruby-2.7.0).
  </div>
  <div id="awsdocs-legal-zone-copyright"></div>
</div>
    </div>
  </body>
</html>
